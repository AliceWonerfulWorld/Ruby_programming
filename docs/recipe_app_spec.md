# レシピ管理アプリ ケーックブック（仕様書）

## 1. プロダクト概要
- **名称（仮）**: CookLog
- **目的**: 個人が日常の料理レシピを整理し、再現しやすくする。材料や手順を明確に記録し、後から検索・共有できる状態を目指す。
- **想定ユーザー**: 自炊初心者〜中級者、家庭の献立を管理したい人。
- **提供価値**:
  - レシピの標準化（タイトル・材料・手順・メモを一元管理）。
  - 材料やタグでの検索により献立決めを時短。
  - 写真・コメントで改善点を残し、レシピを育てる楽しさを提供。

## 2. 主要ユーザーストーリー
- ユーザーとして、新しいレシピを登録して後から再現したい。
- ユーザーとして、材料名で既存レシピを検索し、余っている食材を活用したい。
- ユーザーとして、タグ（「和食」「10分以内」など）でフィルタし、気分に合うレシピを探したい。
- 投稿者として、自分のレシピだけを編集・削除できるようにしたい。
- ユーザーとして、写真付きでレシピを記録し、見た目も確認したい。
- ユーザーとして、実際に作った感想や改善点をコメントとして残したい。

## 3. 機能要件
### フェーズ1〜3: 基本的な CRUD と UX
- レシピ CRUD（タイトル、説明、材料、手順、所要時間、メモ）
- バリデーション（必須項目、文字数制限）
- フォームエラーとフラッシュメッセージ表示
- レイアウト・スタイル調整（最低限の CSS / Bootstrap）

### フェーズ4: 検索・タグ
- タイトル/材料のキーワード検索
- ソート（作成日、所要時間など）
- タグ機能（多対多）とレシピ一覧でのフィルタリング

### フェーズ5: 認証と権限
- Devise を利用したユーザー登録・ログイン
- レシピ投稿者との紐付け
- 投稿者のみ編集・削除可能に制御

### フェーズ6: 画像とコメント
- Active Storage によるレシピ写真アップロード（1枚想定）
- レシピ詳細に写真サムネイル表示
- コメント機能（ユーザー × レシピの 1 対多）

### フェーズ7: 品質向上
- モデルテスト、システムテストの整備
- RuboCop 等での静的解析
- サービスオブジェクト/ヘルパーへロジック分離（200 行以下のファイル構成を意識）

### フェーズ8: 拡張案（任意）
- お気に入り/いいね機能
- 材料の数量管理と買い物リスト出力
- 公開/非公開設定
- JSON API 提供や外部サービス連携

## 4. 非機能要件
- Rails 7.x / Ruby 3.x を想定
- データベース: SQLite3（開発環境）、将来的に PostgreSQL へ移行可能な構成
- 画面レスポンシブ対応（スマホで閲覧可能な最小限のスタイル）
- テストカバレッジの目標: モデル 70%、主要ユースケースのシステムテストを用意
- コード規約: RuboCop に準拠（必要に応じて `.rubocop.yml` を調整）

## 5. ドメインモデル案
-+- `User`: Devise 認証／属性: `name`, `email`, `password_digest`
-+- `Recipe`: 基本情報／属性: `title`, `description`, `ingredients`, `instructions`, `cook_time_minutes`, `notes`, `user_id`
-+- `Tag`: レシピの分類／属性: `name`
-+- `RecipeTag`: 中間テーブル／属性: `recipe_id`, `tag_id`
-+- `Comment`: レシピへのフィードバック／属性: `body`, `user_id`, `recipe_id`
-+- `ActiveStorage::Attachment` / `ActiveStorage::Blob`: 画像格納

## 6. ページ構成（画面ラフ）
- ホーム（`/`）: 最新レシピ一覧、検索フォーム、タグ一覧
- レシピ一覧（`/recipes`）: フィルタ・ソートを適用できるリスト
- レシピ詳細（`/recipes/:id`）: レシピ内容、写真、コメント、編集/削除ボタン（投稿者のみ）
- レシピ新規作成・編集（`/recipes/new`, `/recipes/:id/edit`）
- ユーザー登録/ログイン（Devise 標準ビューをベースにカスタマイズ）

## 7. 開発フェーズと成果物
1. **フェーズ1**: プロジェクト初期設定、仕様整理（本ファイル）
2. **フェーズ2**: レシピ CRUD 実装、種データ投入
3. **フェーズ3**: UX 強化（バリデーション・レイアウト）
4. **フェーズ4**: 検索・タグ機能
5. **フェーズ5**: ユーザー認証・権限
6. **フェーズ6**: 画像アップロード・コメント
7. **フェーズ7**: テスト・リファクタリング
8. **フェーズ8**: 任意拡張

各フェーズ終了時に README へ進捗記録、主要画面のスクリーンショットを貼ることを推奨。

## 8. 成功指標（例）
- 自分または他ユーザーが 10 件以上のレシピを登録し、検索・タグ機能を活用できる。
- コメントや写真を含むレシピが増え、平均再現率（主観評価）が上がる。
- 新しいレシピ追加にかかる時間が 5 分以内まで短縮される。

## 9. 未決定事項・オープンな質問
- 材料や手順をリッチテキストにするか（Action Text を採用するか）
- レシピ共有の範囲（公開範囲設定、URL 共有など）の詳細
- モバイル対応の具体的なレベル（SPA 化、PWA 対応の必要性）
- 国際化への対応範囲（英語表記や単位換算の必要性）

---

この仕様書は学習を進めながら随時更新していく前提です。フェーズが進むごとに決定事項を追記し、オープンな質問を解消していきましょう。

